<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>PDF Editor</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf-lib/1.17.1/pdf-lib.min.js"></script>
    <style>
      /* =========================
         CSS Styles
         ========================= */

      /* Reset and base styles */
      * {
        box-sizing: border-box;
      }

      body {
        font-family: Helvetica, -apple-system, BlinkMacSystemFont, "Segoe UI",
          Arial, sans-serif;
        line-height: 1.6;
        max-width: 1400px;
        margin: 0 auto;
        padding: 20px;
        color: #24292e;
        background: #ffffff;
      }

      h1 {
        border-bottom: 1px solid #eaecef;
        padding-bottom: 0.3em;
        margin-top: 0;
        font-size: 32px;
        font-weight: 600;
      }

      /* Layout */
      .back-link {
        display: inline-block;
        margin-bottom: 16px;
        color: #0366d6;
        text-decoration: none;
        font-size: 14px;
      }

      .back-link:hover {
        text-decoration: underline;
      }

      .description {
        font-size: 14px;
        color: #586069;
        margin-bottom: 24px;
        padding: 12px;
        background: #f6f8fa;
        border-radius: 6px;
        border: 1px solid #e1e4e8;
      }

      /* Main layout */
      .main-container {
        display: grid;
        grid-template-columns: 1fr;
        gap: 20px;
        margin-bottom: 24px;
      }

      @media (min-width: 1024px) {
        .main-container {
          grid-template-columns: 350px 1fr;
        }
      }

      /* Sidebar panel */
      .sidebar {
        display: flex;
        flex-direction: column;
        gap: 16px;
      }

      .panel {
        background: #f6f8fa;
        border: 1px solid #e1e4e8;
        border-radius: 6px;
        padding: 16px;
      }

      .panel-title {
        font-size: 16px;
        font-weight: 600;
        color: #24292e;
        margin: 0 0 12px 0;
        padding-bottom: 8px;
        border-bottom: 1px solid #e1e4e8;
      }

      .controls {
        display: flex;
        flex-direction: column;
        gap: 8px;
      }

      .file-input {
        display: none;
      }

      .file-status {
        font-size: 13px;
        color: #586069;
        padding: 8px 12px;
        background: #ffffff;
        border-radius: 6px;
        border: 1px solid #e1e4e8;
        min-height: 36px;
        display: flex;
        align-items: center;
      }

      .control-buttons {
        display: flex;
        gap: 8px;
      }

      .control-buttons .btn {
        flex: 1;
      }

      /* Buttons */
      .btn {
        background: #fafbfc;
        color: #24292e;
        padding: 8px 12px;
        border-radius: 6px;
        border: 1px solid rgba(27, 31, 35, 0.15);
        cursor: pointer;
        font-size: 14px;
        line-height: 20px;
        text-decoration: none;
        font-family: Helvetica, -apple-system, BlinkMacSystemFont, "Segoe UI",
          Arial, sans-serif;
        display: inline-block;
      }

      .btn:hover {
        background: #f3f4f6;
      }

      .btn.primary {
        background: #0366d6;
        color: #fff;
        border: 1px solid rgba(27, 31, 35, 0.15);
      }

      .btn.primary:hover {
        background: #0256c5;
      }

      .btn:disabled {
        opacity: 0.5;
        cursor: not-allowed;
      }

      .btn:disabled:hover {
        background: #fafbfc;
      }

      .btn.primary:disabled:hover {
        background: #0366d6;
      }

      /* Page selection section */
      .selection-section label {
        display: block;
        font-weight: 600;
        font-size: 13px;
        margin-bottom: 8px;
        color: #24292e;
      }

      .selection-section input[type="text"] {
        width: 100%;
        padding: 8px 12px;
        font-size: 13px;
        border: 1px solid #d1d5da;
        border-radius: 6px;
        background: #ffffff;
        color: #24292e;
        font-family: "SFMono-Regular", Consolas, "Liberation Mono", Menlo,
          monospace;
        margin-bottom: 8px;
      }

      .selection-section input[type="text"]:focus {
        outline: none;
        border-color: #0366d6;
        box-shadow: 0 0 0 3px rgba(3, 102, 214, 0.1);
      }

      .selection-section .hint {
        font-size: 11px;
        color: #586069;
        line-height: 1.5;
      }

      .selection-section .hint code {
        background: #ffffff;
        padding: 2px 4px;
        border-radius: 3px;
        font-size: 11px;
      }

      /* Stats panel */
      .stats-grid {
        display: grid;
        grid-template-columns: 1fr 1fr 1fr;
        gap: 8px;
        align-items: center;
      }

      .stat-item {
        background: #ffffff;
        padding: 8px 12px;
        border-radius: 6px;
        border: 1px solid #e1e4e8;
        text-align: center;
      }

      .stat-value {
        font-size: 20px;
        font-weight: 600;
        color: #24292e;
        display: block;
      }

      .stat-label {
        font-size: 11px;
        color: #586069;
        display: block;
        margin-top: 2px;
      }

      .stat-item.highlight {
        background: #0366d6;
        color: #ffffff;
        border-color: #0366d6;
      }

      .stat-item.highlight .stat-value,
      .stat-item.highlight .stat-label {
        color: #ffffff;
      }

      .stat-item.warning {
        background: #ffeef0;
        border-color: #cb2431;
      }

      .stat-item.warning .stat-value {
        color: #cb2431;
      }

      /* Action buttons */
      .action-section {
        margin-top: 12px;
      }

      .action-section .btn {
        width: 100%;
        padding: 10px 16px;
        font-size: 14px;
        font-weight: 600;
      }

      /* Page grid */
      .content-area {
        display: flex;
        flex-direction: column;
        min-width: 0;
      }

      .pages-container {
        display: none;
      }

      .pages-container.visible {
        display: block;
      }

      .pages-header {
        display: flex;
        align-items: center;
        justify-content: space-between;
        font-size: 16px;
        font-weight: 600;
        margin-bottom: 16px;
        color: #24292e;
        padding-bottom: 8px;
        border-bottom: 1px solid #e1e4e8;
        flex-wrap: wrap;
        gap: 12px;
      }

      .pages-header-text {
        flex: 0 0 auto;
      }

      .loading-container {
        display: none;
        flex: 0 0 auto;
        align-items: center;
        gap: 8px;
        font-size: 13px;
        color: #586069;
      }

      .loading-container.visible {
        display: flex;
      }

      .loading-bar {
        width: 150px;
        height: 6px;
        background: #e1e4e8;
        border-radius: 3px;
        overflow: hidden;
        position: relative;
      }

      .loading-bar-fill {
        height: 100%;
        background: #0366d6;
        border-radius: 3px;
        transition: width 0.3s ease;
        width: 0%;
      }

      .loading-text {
        white-space: nowrap;
      }

      .pages-grid {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(140px, 1fr));
        gap: 12px;
        padding: 16px;
        background: #f6f8fa;
        border-radius: 6px;
        border: 1px solid #e1e4e8;
      }

      @media (min-width: 768px) {
        .pages-grid {
          grid-template-columns: repeat(auto-fill, minmax(160px, 1fr));
        }
      }

      .page-item {
        position: relative;
        border: 2px solid #e1e4e8;
        border-radius: 6px;
        overflow: hidden;
        cursor: pointer;
        transition: all 0.2s ease;
        background: #ffffff;
      }

      .page-item:hover {
        border-color: #0366d6;
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
      }

      .page-item.removed {
        border-color: #cb2431;
      }

      .page-canvas-container {
        position: relative;
        width: 100%;
        padding-top: 141.4%; /* A4 aspect ratio (1:‚àö2) */
        background: #f6f8fa;
      }

      .page-item canvas {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        object-fit: contain;
      }

      .page-overlay {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0, 0, 0, 0);
        display: flex;
        align-items: center;
        justify-content: center;
        transition: all 0.2s ease;
        pointer-events: none;
      }

      .page-item.removed .page-overlay {
        background: rgba(0, 0, 0, 0.6);
      }

      .page-overlay .remove-mark {
        display: none;
        font-size: 64px;
        color: #cb2431;
        font-weight: bold;
        text-shadow: 0 0 10px rgba(255, 255, 255, 0.8);
      }

      .page-item.removed .page-overlay .remove-mark {
        display: block;
      }

      .page-number {
        position: absolute;
        bottom: 0;
        left: 0;
        right: 0;
        background: rgba(0, 0, 0, 0.7);
        color: #ffffff;
        text-align: center;
        padding: 6px;
        font-size: 12px;
        font-weight: 600;
      }

      .page-item.removed .page-number {
        background: rgba(203, 36, 49, 0.9);
      }

      /* Status message */
      .status-message {
        display: none;
        padding: 12px 16px;
        border-radius: 6px;
        margin-bottom: 16px;
        font-size: 13px;
        font-weight: 500;
      }

      .status-message.visible {
        display: block;
      }

      .status-message.info {
        background: #dbedff;
        border: 1px solid #0366d6;
        color: #0366d6;
      }

      .status-message.success {
        background: #dcffe4;
        border: 1px solid #28a745;
        color: #176f2c;
      }

      .status-message.error {
        background: #ffdce0;
        border: 1px solid #cb2431;
        color: #cb2431;
      }

      /* Empty state */
      .empty-state {
        text-align: center;
        padding: 60px 20px;
        color: #586069;
      }

      .empty-state-icon {
        font-size: 64px;
        margin-bottom: 16px;
        opacity: 0.3;
      }

      .empty-state-title {
        font-size: 18px;
        font-weight: 600;
        color: #24292e;
        margin-bottom: 8px;
      }

      .empty-state-text {
        font-size: 14px;
      }

      @media (max-width: 1023px) {
        .main-container {
          grid-template-columns: 1fr;
        }
      }

      @media (max-width: 768px) {
        body {
          padding: 12px;
        }

        .pages-grid {
          grid-template-columns: repeat(auto-fill, minmax(110px, 1fr));
          gap: 8px;
          padding: 12px;
        }

        .page-overlay .remove-mark {
          font-size: 40px;
        }

        .stats-grid {
          grid-template-columns: 1fr;
        }

        .stat-item {
          padding: 10px 12px;
        }
      }
    </style>
  </head>
  <body>
    <a href="index.html" class="back-link">‚Üê Back to Browser Tools</a>

    <h1>PDF Editor</h1>

    <div class="description">
      Remove pages from PDF documents by selecting page ranges or clicking page
      previews. All processing happens in your browser.
    </div>

    <div class="status-message" id="statusMessage"></div>

    <div class="main-container">
      <!-- Sidebar -->
      <div class="sidebar">
        <!-- File controls -->
        <div class="panel">
          <h2 class="panel-title">Load Document</h2>
          <div class="controls">
            <div class="control-buttons">
              <label for="fileInput" class="btn primary">Load PDF</label>
              <input
                type="file"
                id="fileInput"
                class="file-input"
                accept="application/pdf"
              />
              <button id="clearBtn" class="btn" style="display: none">
                Clear
              </button>
            </div>
            <div class="file-status" id="fileStatus">No file loaded</div>
          </div>
        </div>

        <!-- Stats panel -->
        <div class="panel" id="statsPanel">
          <h2 class="panel-title">Document Summary</h2>
          <div class="stats-grid">
            <div class="stat-item">
              <span class="stat-value" id="totalPagesCount">0</span>
              <span class="stat-label">Total</span>
            </div>
            <div class="stat-item highlight">
              <span class="stat-value" id="remainingPagesCount">0</span>
              <span class="stat-label">Keep</span>
            </div>
            <div class="stat-item warning">
              <span class="stat-value" id="removedPagesCount">0</span>
              <span class="stat-label">Remove</span>
            </div>
          </div>
        </div>

        <!-- Page selection -->
        <div class="panel selection-section" id="selectionSection">
          <h2 class="panel-title">Select Pages to Remove</h2>
          <label for="pagesToRemove">Page numbers:</label>
          <input type="text" id="pagesToRemove" placeholder="e.g., 1,5-8" />
          <div class="hint">
            Enter page numbers separated by commas. Use hyphens for ranges
            (e.g.,
            <code>1,5-8</code> removes pages 1, 5, 6, 7, and 8). Click page
            thumbnails below to toggle selection.
          </div>
          <div class="action-section">
            <button id="downloadBtn" class="btn primary">
              Download Edited PDF
            </button>
          </div>
        </div>
      </div>

      <!-- Content area -->
      <div class="content-area">
        <!-- Pages grid -->
        <div class="pages-container visible" id="pagesContainer">
          <div class="pages-header" id="pagesHeader">
            <span class="pages-header-text"
              >Document Pages (click to toggle removal)</span
            >
            <div class="loading-container" id="loadingContainer">
              <div class="loading-bar">
                <div class="loading-bar-fill" id="loadingBarFill"></div>
              </div>
              <span class="loading-text" id="loadingText">Loading...</span>
            </div>
          </div>
          <div class="pages-grid" id="pagesGrid">
            <!-- Empty state -->
            <div
              class="empty-state"
              id="emptyState"
              style="grid-column: 1 / -1"
            >
              <div class="empty-state-icon">üìÑ</div>
              <div class="empty-state-title">No PDF Loaded</div>
              <div class="empty-state-text">Load a PDF file to get started</div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <script type="module">
      /* =========================
         JavaScript
         ========================= */

      // Import PDF.js library
      import * as pdfjsLib from "https://cdn.jsdelivr.net/npm/pdfjs-dist@5.4.449/+esm";

      // Configure PDF.js worker
      pdfjsLib.GlobalWorkerOptions.workerSrc =
        "https://cdn.jsdelivr.net/npm/pdfjs-dist@5.4.449/build/pdf.worker.mjs";

      // State variables
      let currentFile = null;
      let pdfDocument = null;
      let totalPages = 0;
      let removedPages = new Set();

      // DOM elements
      const fileInput = document.getElementById("fileInput");
      const fileStatus = document.getElementById("fileStatus");
      const clearBtn = document.getElementById("clearBtn");
      const statusMessage = document.getElementById("statusMessage");
      const selectionSection = document.getElementById("selectionSection");
      const pagesToRemoveInput = document.getElementById("pagesToRemove");
      const pagesContainer = document.getElementById("pagesContainer");
      const pagesHeader = document.getElementById("pagesHeader");
      const pagesGrid = document.getElementById("pagesGrid");
      const totalPagesCount = document.getElementById("totalPagesCount");
      const removedPagesCount = document.getElementById("removedPagesCount");
      const remainingPagesCount = document.getElementById(
        "remainingPagesCount"
      );
      const downloadBtn = document.getElementById("downloadBtn");
      const emptyState = document.getElementById("emptyState");
      const loadingContainer = document.getElementById("loadingContainer");
      const loadingBarFill = document.getElementById("loadingBarFill");
      const loadingText = document.getElementById("loadingText");

      // Event listeners
      fileInput.addEventListener("change", handleFileSelect);
      clearBtn.addEventListener("click", clearAll);
      pagesToRemoveInput.addEventListener("input", handlePagesInputChange);
      downloadBtn.addEventListener("click", downloadEditedPDF);

      // Utility functions
      function showStatus(message, type = "info") {
        statusMessage.textContent = message;
        statusMessage.className = `status-message visible ${type}`;
        setTimeout(() => {
          statusMessage.classList.remove("visible");
        }, 5000);
      }

      function clearAll() {
        currentFile = null;
        pdfDocument = null;
        totalPages = 0;
        removedPages.clear();
        fileInput.value = "";
        fileStatus.textContent = "No file loaded";
        pagesToRemoveInput.value = "";
        pagesGrid.innerHTML =
          '<div class="empty-state" id="emptyState" style="grid-column: 1 / -1;"><div class="empty-state-icon">üìÑ</div><div class="empty-state-title">No PDF Loaded</div><div class="empty-state-text">Load a PDF file to get started</div></div>';
        clearBtn.style.display = "none";
        loadingContainer.classList.remove("visible");
        // Reset summary counts
        totalPagesCount.textContent = "0";
        removedPagesCount.textContent = "0";
        remainingPagesCount.textContent = "0";
      }

      function parsePageRanges(input) {
        const pages = new Set();
        if (!input.trim()) return pages;

        const parts = input.split(",");
        for (const part of parts) {
          const trimmed = part.trim();
          if (trimmed.includes("-")) {
            // Range like "5-8"
            const [start, end] = trimmed
              .split("-")
              .map((s) => parseInt(s.trim()));
            if (!isNaN(start) && !isNaN(end)) {
              for (
                let i = Math.min(start, end);
                i <= Math.max(start, end);
                i++
              ) {
                if (i >= 1 && i <= totalPages) {
                  pages.add(i);
                }
              }
            }
          } else {
            // Single page
            const page = parseInt(trimmed);
            if (!isNaN(page) && page >= 1 && page <= totalPages) {
              pages.add(page);
            }
          }
        }
        return pages;
      }

      function pagesToString(pagesSet) {
        if (pagesSet.size === 0) return "";

        const sorted = Array.from(pagesSet).sort((a, b) => a - b);
        const ranges = [];
        let start = sorted[0];
        let end = sorted[0];

        for (let i = 1; i < sorted.length; i++) {
          if (sorted[i] === end + 1) {
            end = sorted[i];
          } else {
            if (start === end) {
              ranges.push(`${start}`);
            } else if (end === start + 1) {
              ranges.push(`${start},${end}`);
            } else {
              ranges.push(`${start}-${end}`);
            }
            start = sorted[i];
            end = sorted[i];
          }
        }

        // Add the last range
        if (start === end) {
          ranges.push(`${start}`);
        } else if (end === start + 1) {
          ranges.push(`${start},${end}`);
        } else {
          ranges.push(`${start}-${end}`);
        }

        return ranges.join(",");
      }

      function updatePageVisuals() {
        const pageItems = pagesGrid.querySelectorAll(".page-item");
        pageItems.forEach((item) => {
          const pageNum = parseInt(item.dataset.page);
          if (removedPages.has(pageNum)) {
            item.classList.add("removed");
          } else {
            item.classList.remove("removed");
          }
        });
        updateDownloadInfo();
      }

      function updateDownloadInfo() {
        const remainingPages = totalPages - removedPages.size;
        totalPagesCount.textContent = totalPages;
        removedPagesCount.textContent = removedPages.size;
        remainingPagesCount.textContent = remainingPages;
      }

      function handlePagesInputChange() {
        const input = pagesToRemoveInput.value;
        removedPages = parsePageRanges(input);
        updatePageVisuals();
      }

      function handlePageClick(pageNum) {
        if (removedPages.has(pageNum)) {
          removedPages.delete(pageNum);
        } else {
          removedPages.add(pageNum);
        }

        // Update input field
        pagesToRemoveInput.value = pagesToString(removedPages);

        // Update visuals
        updatePageVisuals();
      }

      async function handleFileSelect(e) {
        const files = e.target.files;
        if (files.length > 0) {
          await handleFile(files[0]);
        }
      }

      async function handleFile(file) {
        currentFile = file;
        const fileName = file.name.toLowerCase();

        // Validate file type
        if (!fileName.endsWith(".pdf")) {
          showStatus("Please select a PDF file", "error");
          fileStatus.textContent = "No file loaded";
          return;
        }

        fileStatus.textContent = file.name;
        clearBtn.style.display = "inline-block";

        try {
          showStatus("Loading PDF...", "info");

          // Load PDF
          const arrayBuffer = await file.arrayBuffer();
          pdfDocument = await pdfjsLib.getDocument({
            data: arrayBuffer,
          }).promise;
          totalPages = pdfDocument.numPages;

          showStatus(`Loaded PDF with ${totalPages} pages`, "success");

          // Render all pages
          await renderAllPages();

          updateDownloadInfo();
        } catch (error) {
          console.error("Error loading PDF:", error);
          showStatus("Error loading PDF: " + error.message, "error");
        }
      }

      async function renderAllPages() {
        pagesGrid.innerHTML = "";
        removedPages.clear();
        pagesToRemoveInput.value = "";

        // Show loading bar
        loadingContainer.classList.add("visible");

        for (let pageNum = 1; pageNum <= totalPages; pageNum++) {
          // Update loading progress
          const progress = (pageNum / totalPages) * 100;
          loadingBarFill.style.width = progress + "%";
          loadingText.textContent = `Loading ${pageNum}/${totalPages}`;
          try {
            const page = await pdfDocument.getPage(pageNum);
            const scale = 0.5; // Small thumbnails
            const viewport = page.getViewport({ scale });

            // Create canvas
            const canvas = document.createElement("canvas");
            const context = canvas.getContext("2d");
            canvas.width = viewport.width;
            canvas.height = viewport.height;

            // Render page
            await page.render({
              canvasContext: context,
              viewport: viewport,
            }).promise;

            // Create page item
            const pageItem = document.createElement("div");
            pageItem.className = "page-item";
            pageItem.dataset.page = pageNum;
            pageItem.addEventListener("click", () => handlePageClick(pageNum));

            const canvasContainer = document.createElement("div");
            canvasContainer.className = "page-canvas-container";
            canvasContainer.appendChild(canvas);

            const overlay = document.createElement("div");
            overlay.className = "page-overlay";

            const removeMark = document.createElement("div");
            removeMark.className = "remove-mark";
            removeMark.textContent = "‚úï";
            overlay.appendChild(removeMark);

            canvasContainer.appendChild(overlay);

            const pageNumber = document.createElement("div");
            pageNumber.className = "page-number";
            pageNumber.textContent = `Page ${pageNum}`;

            pageItem.appendChild(canvasContainer);
            pageItem.appendChild(pageNumber);
            pagesGrid.appendChild(pageItem);
          } catch (error) {
            console.error(`Error rendering page ${pageNum}:`, error);
          }
        }

        // Hide loading bar
        loadingContainer.classList.remove("visible");
      }

      async function downloadEditedPDF() {
        if (!currentFile) return;

        try {
          downloadBtn.disabled = true;

          // Show loading bar for processing
          loadingContainer.classList.add("visible");
          loadingBarFill.style.width = "0%";
          loadingText.textContent = "Loading PDF...";

          // Load the original PDF with pdf-lib
          // Use options to handle problematic PDFs with invalid objects or encryption
          const existingPdfBytes = await currentFile.arrayBuffer();

          const pdfDoc = await PDFLib.PDFDocument.load(existingPdfBytes, {
            ignoreEncryption: true,
            throwOnInvalidObject: false,
            updateMetadata: false,
          });

          loadingBarFill.style.width = "10%";
          loadingText.textContent = "Creating new document...";

          // Create a new PDF
          const newPdfDoc = await PDFLib.PDFDocument.create();

          // Copy pages that are not marked for removal
          let copiedCount = 0;
          const totalToCopy = totalPages - removedPages.size;

          for (let i = 1; i <= totalPages; i++) {
            if (!removedPages.has(i)) {
              try {
                const [copiedPage] = await newPdfDoc.copyPages(pdfDoc, [i - 1]);
                newPdfDoc.addPage(copiedPage);
                copiedCount++;

                // Update progress (10% to 80% range for copying)
                const copyProgress = 10 + (copiedCount / totalToCopy) * 70;
                loadingBarFill.style.width = copyProgress + "%";
                loadingText.textContent = `Copying pages... ${copiedCount}/${totalToCopy}`;

                // Allow UI to update
                await new Promise((resolve) => setTimeout(resolve, 0));
              } catch (pageError) {
                console.warn(`Warning: Could not copy page ${i}:`, pageError);
              }
            }
          }

          // Save the new PDF
          loadingBarFill.style.width = "85%";
          loadingText.textContent = "Saving PDF...";

          const pdfBytes = await newPdfDoc.save();

          loadingBarFill.style.width = "95%";
          loadingText.textContent = "Preparing download...";

          const blob = new Blob([pdfBytes], {
            type: "application/pdf",
          });
          const url = URL.createObjectURL(blob);

          // Download
          const a = document.createElement("a");
          a.href = url;
          const originalName = currentFile.name.replace(/\.pdf$/i, "");
          a.download = `${originalName}-EDITED.pdf`;
          a.click();

          URL.revokeObjectURL(url);

          loadingBarFill.style.width = "100%";
          loadingText.textContent = "Complete!";

          setTimeout(() => {
            loadingContainer.classList.remove("visible");
          }, 1000);

          showStatus(
            `PDF downloaded successfully! (${copiedCount} pages)`,
            "success"
          );
        } catch (error) {
          loadingContainer.classList.remove("visible");
          showStatus(
            "Error creating PDF: " +
              error.message +
              ". This PDF may be too corrupted to edit. Try a different PDF repair tool first.",
            "error"
          );
        } finally {
          downloadBtn.disabled = false;
        }
      }
    </script>
  </body>
</html>
